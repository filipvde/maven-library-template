name: Main Workflow Dispatcher

on:
  push:
    branches:
      - "**"   # Runs on all branches except master (handled separately)
  pull_request:
    branches:
      - "**"

jobs:
  test:
    uses: ./.github/workflows/partially-workflows/test-workflow.yml  # Calls test workflow
  
  build:
    uses: ./.github/workflows/partially-workflows/build-workflow.yml  # Calls build workflow

  deploy:
    if: github.ref == 'refs/heads/master' || github.ref == 'refs/heads/main'  # Only deploy on master/main
    uses: ./.github/workflows/partially-workflows/deploy-workflow.yml